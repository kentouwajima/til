# ネットワーク基礎まとめ（TCP / UDP / TLS）

## 1. ネットワーク全体のレイヤー構造（俯瞰）

通信は役割ごとに階層化されている。

- アプリケーション層：HTTP / HTTPS / FTP / SMTP
- セキュリティ層　　：TLS
- トランスポート層　：TCP / UDP
- ネットワーク層　　：IP

IP：どこに送るか（住所）  
TCP / UDP：どうやって運ぶか  
TLS：盗み見されないようにする  
HTTP：中身のルール  

---

## 2. TCP（Transmission Control Protocol）

### 概要
正確性を最優先する通信方式。

### 特徴
- データの順序保証あり
- 再送制御あり
- 信頼性が高い
- その分、速度はUDPより遅い

### 主な用途
- HTTP
- HTTPS
- SSH
- SMTP

### イメージ
荷物がすべて揃うまで何度でも送り直す宅配便。

---

## 3. UDP（User Datagram Protocol）

### 概要
速度最優先の通信方式。

### 特徴
- 順序保証なし
- 再送なし
- 届いたかどうかの確認なし
- 非常に高速

### 主な用途
- オンラインゲーム
- 音声通話（VoIP）
- 動画ストリーミング
- DNS（一部）

### イメージ
多少欠けても止まらない生配信。

---

## 4. TCPとUDPの比較

| 項目 | TCP | UDP |
|---|---|---|
| 信頼性 | 高い | 低い |
| 速度 | 遅め | 速い |
| 再送 | あり | なし |
| 順序保証 | あり | なし |
| 用途 | Web / 業務 | リアルタイム |

---

## 5. TLS（Transport Layer Security）

### 概要
通信内容を暗号化する仕組み。

### TLSの役割
- 通信の暗号化
- 相手の認証（証明書）
- 改ざん防止

### 重要ポイント
TLSは単体では使えず、必ずTCPと組み合わせて利用される。

TCP + TLS = 暗号化通信

---

## 6. HTTPSの正体

HTTPS = HTTP + TLS + TCP

- HTTP：通信ルール
- TLS：暗号化
- TCP：正確に運ぶ

ブラウザの鍵マークはTLSが有効な証拠。

---

## 7. AWSにおけるTCP / UDP / TLS

### ALB（Application Load Balancer）

対応プロトコル：
- HTTP
- HTTPS（TCP + TLS）

特徴：
- 通信内容（HTTPヘッダ）を理解できる
- パスベース・ホストベースルーティングが可能

---

### NLB（Network Load Balancer）

対応プロトコル：
- TCP
- UDP
- TLS

特徴：
- 通信内容は見ない
- 高速・低レイテンシ
- プロトコルレベルで転送

---

## 8. ALBとNLBの使い分け

| 項目 | ALB | NLB |
|---|---|---|
| レイヤー | L7 | L4 |
| 中身の理解 | できる | できない |
| HTTPルーティング | 可能 | 不可 |
| UDP対応 | × | ○ |
| 主用途 | Web | 高速通信 |

---

## 9. TLS終端とパススルー

### TLS終端（ALB）
クライアント → HTTPS → ALB → HTTP → EC2  
ALBで復号し、サーバはHTTPのみ。

### TLSパススルー（NLB）
クライアント → HTTPS → EC2  
暗号化は最後まで維持され、サーバ側で証明書管理が必要。

---

## 10. 重要ポイントまとめ

- TCP：正確性重視
- UDP：速度重視
- TLS：暗号化
- HTTPS：HTTP + TLS + TCP
- ALB：中身を理解して振り分け
- NLB：高速にそのまま転送
